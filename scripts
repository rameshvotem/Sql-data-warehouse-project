=======================
Create Database and Schemas
=======================================
Purpose:
This Script created a new database names 'DataWarehouse' after checkimh if it already exists.
if the database exists, it is dropped and recreated. Additionally, the script sets up three schemas within the database:
'bronze','silver', and 'gold'.

Warning:
Running this script will drop the entire 'Datawarehouse' DB if it exists.
All data in the DB will be permanently  deleted. proceed with caution and ensure you have proper backups before running this script.

*/


USE master;

GO
---Drop and recreate the 'Datawarehouse' DB
IF EXISTS ( SELECT 1 FROM sys.databases WHERE name = 'Datawarehouse')
BEGIN
ALTER DATABASE DATAWAREHOUSE SET SINGLE USER WITH ROLLBACK IMMEDIATE:
DROP DATABASE Datawarehouse;
END;
GO
